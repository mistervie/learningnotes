#VIEWeibo

### UIWebView
- 使用方法
```objc
//字符串转NSURL
NSURL *url = [NSURL URLWithString:@"https://api.weibo.com/oauth2/authorize?client_id=3082368261&redirect_uri=https://github.com/mistervie"];
NSURLRequest *ur = [NSURLRequest requestWithURL:url];
//loadRequest方法来请求request
[webView loadRequest:ur];
```
- 如果要拦截webview每次的请求，则需要实现UIWebView的代理 UIWebViewDelegate

```objc
webView.delegate = webview的代理;
//实现代理方法
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{
    
    NSLog(@"%@",request.URL.query);
    if ([request.URL.absoluteString hasPrefix:@"https://github.com/mistervie"]) {
        NSString *resultURL = request.URL.query;
        NSString *hasCode = @"code=";
        if ([resultURL hasPrefix:hasCode]) {
            NSLog(@"授权成功！");
            NSString *code = [resultURL substringFromIndex:hasCode.length];
            self.code = code;
            NSLog(@"%@",self.code);
            [self getToken:code];
        }else{
            NSLog(@"Fail!");
        }
    }else{
        return YES;
    }
    return YES;
}
```
- 注：[request.URL.absoluteString hasPrefix:@"https://github.com/mistervie"]
方法可以判定url中是否以“https://github.com/mistervie”为起始


### AFNetworking的单例模式
- 如果Project中需要访问很多次同样前缀的URl请求，则可以使用单例模式
- 重写AFHttpSessionManager的manager方法。例如：

```objc
#import "VIEHTTPSessionManager.h"

@implementation VIEHTTPSessionManager

static VIEHTTPSessionManager *_sessionManager;
+(instancetype)manager{
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        NSURL *url = [NSURL URLWithString:@"https://api.weibo.com/"];
        _sessionManager = [[[self class] alloc] initWithBaseURL:url];
    });
    return _sessionManager;
}
@end
```
- 有时需要设定服务器所支持的ContentTypes
```objc
session.responseSerializer.acceptableContentTypes = [NSSet setWithObject:@"text/plain"];
```
